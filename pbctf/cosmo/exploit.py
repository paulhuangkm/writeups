from pwn import *
import string
import os

charset = string.ascii_letters + string.digits + " {}_.?"
os.write(2, f"{charset}".encode())
flag = "pbctf678901234567890123456789012345aaa"
index = 4
while index < 38:
    end = False
    for i in range(len(charset)):
        os.write(2, f"{charset[i]}\n".encode())
        for j in range(len(charset)):
            os.write(2, f"i, j = {i}, {j}: \n".encode())
            a, b = charset[i], charset[j]
            tmp_flag = flag[:index] + a + b + flag[(index+2):]
            try:
                r = process(["./hello.com", tmp_flag])
                res = r.recvline().decode("utf-8")
                r.close()
                os.write(2, f"{tmp_flag[:(index+2)]}: {res}\n".encode())
                if res[0] != "N"[0]:
                    flag = tmp_flag
                    end = True
                    break
            except EOFError:
                j -= 1
                continue
        os.write(2, f"{end}".encode())
        if end:
            break
    os.write(2, f"Current flag: {flag}\n".encode())
    os.write(2, "Next!!!".encode())
    index += 2
    input()